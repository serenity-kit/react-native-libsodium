# Repository Guidelines

## Project Structure & Module Organization
- `src/`: TypeScript source for the library (`src/index` is the entry point).
- `lib/`: built output generated by `react-native-builder-bob` (do not edit by hand).
- `ios/`, `android/`, `cpp/`: native implementations and headers; `react-native-libsodium.podspec` wires iOS.
- `libsodium/`: vendored C library and build artifacts (`build.sh`, `build.tgz`).
- `example/`: React Native example app used for manual testing.
- `example/src/tests/`: platform test cases used by `example/src/components/TestResults.tsx`.
- `e2e-tests/`: Playwright web tests and Maestro flows.
- `scripts/`: helper scripts; `app.plugin.js` provides the Expo config plugin.

## Build, Test, and Development Commands
- `yarn`: install dependencies (project expects Yarn 1.x).
- `yarn bootstrap`: install deps and iOS pods for the example app.
- `yarn example start`: start Metro for the example app.
- `yarn example android` / `yarn example ios` / `yarn example web`: run the example app on each platform.
- `yarn typecheck`: TypeScript type check.
- `yarn lint` / `yarn lint --fix`: ESLint + Prettier checks and autofix.
- `yarn test`: Jest unit tests.
- `yarn test:e2e:web`: Playwright E2E tests (`e2e-tests/web/*.e2e.ts`).
- `maestro test e2e-tests/maestro-flow-ios.yml`: iOS E2E flow (Android flow via CI).
- `yarn prepack`: build `lib/` output via Bob before publishing.

## Coding Style & Naming Conventions
- Indentation: 2 spaces, LF endings (see `.editorconfig`).
- Formatting: Prettier with single quotes and trailing commas (ES5).
- Linting: ESLint with `@react-native-community` config; keep TypeScript types explicit where helpful.

## Testing Guidelines
- Unit tests run with Jest (`yarn test`).
- For feature work, add tests under `example/src/tests/` and register them in `example/src/components/TestResults.tsx`.
- Verify test results across web, iOS, and Android to keep behavior consistent.

## Commit & Pull Request Guidelines
- Commit messages follow Conventional Commits (e.g., `feat: ...`, `fix: ...`). Commitlint + Lefthook enforce this.
- Keep PRs small and focused, run `yarn lint` and tests, and update docs when behavior changes.
- Follow the PR template and open an issue before API/behavior changes to align with maintainers.

## Native Library Updates
- When updating libsodium, place the new minisig in `libsodium/`, update `libsodium/build.sh`, and rebuild via `cd libsodium && ./build.sh`.
